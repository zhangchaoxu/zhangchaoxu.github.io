---
layout:     post
category:   "tech"
title:      "网站性能优化"
subtitle:   "Web Performance Enhancement"
date:       2012-06-18 03:22
author:     "Charles"
header-img: "img/post-bg-01.jpg"
---

<p>&#160;&#160;&#160; 首先我得承认，自己并没有大型网站(大访问量、大数据量)的网站建站与维护经验。手头做过最大访问量的一个网站也不过是北京交通大学 数字校园的WAP站点(<a href="http://wap.bjtu.edu.cn/">http://wap.bjtu.edu.cn/</a>)，这个网站确实是我从零搭建起来的，不过由于项目经费限制，也并没有在硬件上做任何优化，甚至web服务器和db服务器都是同一台的。所做的只是在软件层面上尽量地小心，避免很多会对网站性能和响应速度带来影响的因素，最直接也是最有效的一个措施就是页面静态化。</p>  <p>&#160;&#160;&#160; 想要谈网站性能优化是由于看到<a href="http://www.cnblogs.com/willsonchan/archive/2012/01/21/2328427.html" target="_blank">WilsonChan</a>在博客园中的一篇日志，日志分析了淘宝首页的一个运行流程，以及从你在地址框输入<a href="http://www.taobao.com/">http://www.taobao.com/</a>到页面显示的整个流程。提到了一些技术，也结合自己的实际经验与认识，谈谈网站性能优化。关于这个网站性能优化，建议先看一下Yahoo!Exceptional Performance团队分享的一个<a href="http://blog.csdn.net/alex86gbk/article/details/4438506" target="_blank">34条黄金法则</a>。</p>  <p>&#160;&#160;&#160; 网站性能优化，直接点说就是减少页面的相应时间，给用户提供一个更加良好的用户体验。</p>  <p>&#160;&#160;&#160; <strong>一、减小页面体积</strong></p>  <p>&#160;&#160;&#160; 为了加快速度，最简单也是最有效的办法就是减小页面体积。百度加载速度永远比新浪快。为什么，因为整个百度首页就只要一张logo图和一张ICP备案的小图，以及一个js文件，总共不到20K。而新浪的首页则包含了近百张的图片，以及各种include将来的子页面。当然两者的用户应用不同，举这个例子只是想说明，减小页面体积是最有效的方法。</p>  <p>&#160;&#160;&#160; 至于减小页面体积，方法也有很多，页面中包含的一般是js、css、image、coockie四类文件，精简javascript、css代码(剔除注释、换行、空格等，利用工具精简)，剔除重复的图片这是首先想到的。</p>  <p>&#160;&#160;&#160; 对于css避免使用css 表达式Expression和滤镜。</p>  <p>&#160;&#160;&#160; 对于image做相应的压缩，并且利用CSS精灵CSS Spirite将同一个页面中常用图片压缩到一张中，以上都是常见的措施。</p>  <p>&#160;&#160;&#160; 对于coockie则应该设置合理的有效期，也可以减少体积。</p>  <p>&#160;&#160;&#160; 最后可以利用Gzip对页面进行压缩编码，这也是目前常用的方法。</p>  <p>&#160; <strong>&#160; 二、减少HTTP请求数量</strong></p>  <p>&#160;&#160;&#160; 由于浏览器并行加载同域名下HTTP请求的数量是有限制的，按照HTTP1.1协议是2个，<a href="http://www.iefans.net/qingqiu-bingfa-lianjieshu-xianzhi/" target="_blank">实际IE8能扩展到10个，FireFox3+和Chrome5+是6个</a>，因此应该将js、css、image等其他的HTTP请求资源放在其他的域名中，并且对于这些静态资源可以利用Apache、Nginx等对静态资源更加高效的web服务器(Tomcat会把每一个请求都当作servlet来处理)。</p>  <p>&#160;&#160;&#160; <strong>三、合理安排加载顺序</strong></p>  <p><strong>&#160;&#160;&#160; </strong>根据文件重要程度，对当前不是必须的文件采用推迟加载，对重要的文件采用预加载。比如在用户下一步操作中可能会用到的文件预先加载，比如在google搜索页面，输入框中输入内容的时候就会预先加载在搜索结果显示页面所需要的文件。UC浏览器有一个阅读模式，也就是在用户阅读当前页的时候就预先加载下一页中的内容，提供一个更加良好的用户体验。</p>  <p>&#160;&#160; <strong> 四、页面缓存</strong></p>  <p><strong>&#160;&#160;&#160; </strong>可以将动态页面静态化、以及增加页面查询缓存等方法提高网站性能。</p>  <p>&#160;&#160;&#160; <strong>五、访问的负载均衡</strong></p>  <p><strong>&#160;&#160;&#160; </strong>根据访问的ip等用户信息，在DNS上设置负载均衡。把用户均匀分配到不同分服务器。</p>  <p>&#160;&#160;&#160; 利用CDN内容分发，将用户连接到最近的服务器中。</p>  <p>&#160;&#160;&#160; <strong>六、数据优化</strong></p>  <p><strong>&#160;&#160;&#160; </strong>6.1 数据冗余，减少表连接，较少开销；</p>  <p>&#160;&#160;&#160; 6.2 数据镜像，replicatipn,实现负载均衡，并且保证数据的一致性；</p>  <p>&#160;&#160;&#160; 6.3 数据分区</p>  <p>&#160;</p>  <p>最后两块负载均衡和数据优化，下次i再细谈。</p>
